<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sseju.java.workorder.mapper.WorkOrderMapper">
	<!-- 전체조회 -->
	<select id="getWorkOrderList" resultType="woVO">
		SELECT *
		FROM produce
		ORDER BY preNo DESC
	</select>
	<!-- 단건조회 -->
	<select id="getSearchWorkOrder" parameterType="woVO" resultType="woVO">
		SELECT pre_no,
			   pre_date,
			   pre_manager,
			   ins_qty,
			   pre_qty,
			   prt_code,
			   oder_no,
			   pre_prg
		FROM produce
		<where>
			<if test="preNo > 0"></if>
			preNo = ${preNO}
		</where>
	</select>
	<!-- 등록 -->
	<insert id="insertWorkOrder" parameterType="woVO">
		INSERT INTO produce( pre_no
						    ,pre_date
						    ,pre_manager
						    ,ins_qty
						    ,pre_qty
						    ,prt_code
						    ,oder_no
						    ,pre_prg)
				   VALUES( #{preNo}
						   ,#{preDate}
						   ,#{preManager}
						   ,#{insQty}
						   ,#{preQty}
						   ,#{prtCode}
						   ,#{oderNo}
						   ,#{prePrg})
	</insert>
	<!-- 수정 -->
	<update id="updateWorkOrder" parameterType="woVO">
		UPDATE produce
		<set>
			pre_manager = #{preManager},
			ins_qty = #{insQty},
			pre_qty = #{preQty},
			pre_prg = #{prePrg}
		</set>
		WHERE pre_no = #{preNo}
	</update>
	
	<!-- 삭제 -->
	<delete id="deleteWorkOrder" parameterType="Integer">
		DELETE FROM produce
		WHERE pre_no = #{preNo}
	</delete>
	
	<!-- 작업 지시 번호 조회 -->
	<select id="getWoNo" resultType="woVO">
		SELECT TO_CHAR(SYSDATE,'YYYYMMDD')||'-'||LPAD(NVL(MAX(SUBSTR(pre_no, -3)),0)+1,3,0) FROM produce
	</select>
</mapper>