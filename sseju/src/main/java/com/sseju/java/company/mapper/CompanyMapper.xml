<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.sseju.java.company.mapper.CompanyMapper">

	<select id="getCompanyList">
		SELECT * FROM company
	</select>
	<insert id="insertLogin" parameterType="CompanyVO">
		INSERT INTO login values (#{id}, #{auth}, #{password})
	</insert>
	
	<select id="companyCode" parameterType="CompanyVO" resultType="String">
		SELECT cp_code FROM company
	</select>
	
	<select id="getCompanyInfo" parameterType="CompanyVO" resultType="CompanyVO">
		SELECT * FROM company WHERE cp_code = #{cpCode}
	</select>
	
	<insert id="insertCompany" parameterType="CompanyVO">
		<selectKey keyProperty="cpCode" resultType="String" order="BEFORE">
			SELECT 'CP_'||LPAD(NVL(MAX(SUBSTR(cp_code, -3)),0)+1,3,0) FROM company
		</selectKey>
		INSERT INTO company values (#{cpCode}, #{cpName}, #{cpCeo}, #{cpTel}, #{cpNo}, #{cpAddr}, #{id})
	</insert>
	
	<delete id="deleteCompany" parameterType="CompanyVO">
		DELETE FROM company WHERE cp_code = #{cpCode}
	</delete>
</mapper>